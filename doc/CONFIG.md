# é…ç½®

ä»¥ä¸‹ä»‹ç» clash-rules çš„é…ç½®é€‰é¡¹ã€‚

- [é…ç½®](#é…ç½®)
  - [rules](#rules)
    - [Rule](#rule)
    - [URLTest](#urltest)
    - [Fallback](#fallback)
  - [override](#override)

## rules

`(Rule | URLTest | Fallback)[]`ï¼šè§„åˆ™åˆ—è¡¨ã€‚

### Rule

```typescript
interface Rule {
  type: 'select'
  rule?: URL | string
  name: string
  behavior?: 'classical' | 'ipcidr' | 'domain'
  interval?: number
  proxy?: string[]
  preferred?: string[]
  reuse?: boolean
}
```

1. typeï¼šå¿…é¡»æŒ‡å®šä¸º `select`ï¼Œç”¨äºåŒºåˆ†å¤šä¸ªç±»å‹ã€‚
2. ruleï¼šåœ¨çº¿çš„ URL è·¯å¾„ï¼Œæˆ–è€…å†…è”çš„å•æ¡è§„åˆ™ã€‚ä¸ºç©ºæ—¶ä¸å®é™…å¯¼å…¥è§„åˆ™é›†ï¼Œåªç”Ÿæˆä»£ç†é›†ã€‚å½“éœ€è¦æŒ‡å®šæœ¬åœ°æ–‡ä»¶æ—¶ï¼Œè¯·ä½¿ç”¨ `file` åè®®å¤´ï¼Œå¹¶ä¸”åªå…è®¸ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆClash home directory ä½œä¸ºåŸºå‡†è·¯å¾„ï¼‰ã€‚

   - å†…è”è§„åˆ™æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

   ```
   GEOIP,CN
   MATCH
   ```

   åˆ™æœ€ç»ˆç”Ÿæˆçš„è§„åˆ™ä¸ºï¼š

   ```
   GEOIP,CN,ğŸ‡¨ğŸ‡³ ä¸­å›½å¤§é™†
   MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
   ```

3. nameï¼šç”¨æˆ·å¯è¯»çš„åç§°ã€‚
4. behaviorï¼šæ§åˆ¶é…ç½®è§£é‡Šçš„è¡Œä¸ºã€‚é»˜è®¤ä¸º `classical`ã€‚
5. intervalï¼šclash æ›´æ–°é…ç½®çš„å¾ªç¯å‘¨æœŸã€‚é»˜è®¤ä¸º `86400`ã€‚
6. proxyï¼šæŒ‡å®šä»£ç†é›†å¯¹åº”çš„ `proxy` åˆ—è¡¨ã€‚ä¸æŒ‡å®šæ—¶é»˜è®¤ä¸ºåŸé…ç½®çš„å…¨éƒ¨ä»£ç†/ä»£ç†é›†ã€‚
7. preferredï¼šæŒ‡å®šçš„ä»£ç†å°†è¢«æŒ‰é¡ºåºä¼˜å…ˆåŠ å…¥åˆ°ä»£ç†é›†ä¸­ï¼Œè€Œä¸ç®¡å®ƒæ˜¯å¦å­˜åœ¨ã€‚
8. reuseï¼šæŒ‡å®šè¯¥ä»£ç†é›†åŒæ—¶å¯ä»¥è¢«å…¶å®ƒç”Ÿæˆçš„ä»£ç†é›†ä½¿ç”¨ã€‚è¿™æ„å‘³ç€å…¶å®ƒçš„ä»£ç†é›†å°†æŠŠæ­¤ä»£ç†é›†ä½œä¸ºå¯é€‰ä»£ç†ã€‚é»˜è®¤ä¸º `false`ã€‚

### URLTest

```typescript
interface URLTest {
  type: 'url-test'
  url: URL
  name: string
  interval: number
  tolerance: number
  proxy?: string[]
  preferred?: string[]
  reuse?: boolean
}
```

1. typeï¼šå¿…é¡»æŒ‡å®šä¸º `url-test`ï¼Œç”¨äºåŒºåˆ†å¤šä¸ªç±»å‹ã€‚
2. urlï¼šURL æµ‹è¯•ä½¿ç”¨çš„ URLã€‚
3. nameï¼šåœ¨ proxy-groups ä¸­æ˜¾ç¤ºçš„åç§°ã€‚
4. intervalï¼šURL æµ‹è¯•é—´éš”ã€‚
5. toleranceï¼šå…è®¸çš„å»¶è¿Ÿåå·®å€¼ã€‚
6. proxyï¼šè¦æ±‚ url-test åœ¨æŒ‡å®šçš„ä»£ç†åˆ—è¡¨ä¸­åšå‡ºé€‰æ‹©ã€‚
7. preferredï¼šæŒ‡å®šçš„ä»£ç†å°†è¢«æŒ‰é¡ºåºä¼˜å…ˆåŠ å…¥åˆ°ä»£ç†é›†ä¸­ï¼Œè€Œä¸ç®¡å®ƒæ˜¯å¦å­˜åœ¨ã€‚
8. reuseï¼šæŒ‡å®šè¯¥ä»£ç†é›†åŒæ—¶å¯ä»¥è¢«å…¶å®ƒç”Ÿæˆçš„ä»£ç†é›†ä½¿ç”¨ã€‚è¿™æ„å‘³ç€å…¶å®ƒçš„ä»£ç†é›†å°†æŠŠæ­¤ä»£ç†é›†ä½œä¸ºå¯é€‰ä»£ç†ã€‚é»˜è®¤ä¸º `false`ã€‚

### Fallback

```typescript
interface Fallback {
  type: 'fallback'
  url: URL
  name: string
  interval: number
  proxy?: string[]
  preferred?: string[]
  reuse?: boolean
}
```

1. typeï¼šå¿…é¡»æŒ‡å®šä¸º `fallback`ï¼Œç”¨äºåŒºåˆ†å¤šä¸ªç±»å‹ã€‚
2. urlï¼šURL æµ‹è¯•ä½¿ç”¨çš„ URLã€‚
3. nameï¼šåœ¨ proxy-groups ä¸­æ˜¾ç¤ºçš„åç§°ã€‚
4. intervalï¼šURL æµ‹è¯•é—´éš”ã€‚
5. proxyï¼šè¦æ±‚ fallback åœ¨æŒ‡å®šçš„ä»£ç†åˆ—è¡¨ä¸­åšå‡ºé€‰æ‹©ã€‚
6. preferredï¼šæŒ‡å®šçš„ä»£ç†å°†è¢«æŒ‰é¡ºåºä¼˜å…ˆåŠ å…¥åˆ°ä»£ç†é›†ä¸­ï¼Œè€Œä¸ç®¡å®ƒæ˜¯å¦å­˜åœ¨ã€‚
7. reuseï¼šæŒ‡å®šè¯¥ä»£ç†é›†åŒæ—¶å¯ä»¥è¢«å…¶å®ƒç”Ÿæˆçš„ä»£ç†é›†ä½¿ç”¨ã€‚è¿™æ„å‘³ç€å…¶å®ƒçš„ä»£ç†é›†å°†æŠŠæ­¤ä»£ç†é›†ä½œä¸ºå¯é€‰ä»£ç†ã€‚é»˜è®¤ä¸º `false`ã€‚

## override

`string[]`ï¼šå½“æŒ‡å®šæ—¶ï¼Œå°†ç›´æ¥æ¸…ç©ºæŒ‡å®šçš„é”®åä¸‹çš„å…¨éƒ¨å€¼ï¼Œæ¯”å¦‚ `rules`ï¼Œ`rule-providers` ç­‰ã€‚
